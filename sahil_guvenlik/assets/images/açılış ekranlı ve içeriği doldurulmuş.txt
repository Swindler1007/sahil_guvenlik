import 'package:flutter/material.dart';
import 'package:url_launcher/url_launcher.dart';

void main() {
  runApp(MyApp());
}

class MyApp extends StatelessWidget {
  const MyApp({super.key});

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'SG-CEP - Sahil Güvenlik Eğitim Platformu',
      theme: ThemeData(
        primarySwatch: Colors.blue,
        fontFamily: 'Roboto',
        elevatedButtonTheme: ElevatedButtonThemeData(
          style: ElevatedButton.styleFrom(
            padding: EdgeInsets.symmetric(vertical: 16, horizontal: 24),
            shape: RoundedRectangleBorder(
              borderRadius: BorderRadius.circular(12),
            ),
            textStyle: TextStyle(fontSize: 16, fontWeight: FontWeight.w600),
          ),
        ),
        inputDecorationTheme: InputDecorationTheme(
          filled: true,
          fillColor: Color.fromRGBO(255, 255, 255, 0.95),
          border: OutlineInputBorder(
            borderRadius: BorderRadius.circular(12),
            borderSide: BorderSide.none,
          ),
          contentPadding: EdgeInsets.symmetric(vertical: 16, horizontal: 20),
        ),
      ),
      home: SplashScreen(),
    );
  }
}

// A. AÇILIŞ EKRANI
class SplashScreen extends StatefulWidget {
  const SplashScreen({super.key});

  @override
  State<SplashScreen> createState() => _SplashScreenState();
}

class _SplashScreenState extends State<SplashScreen> {
  @override
  void initState() {
    super.initState();
    _navigateToHome();
  }

  void _navigateToHome() {
    Future.delayed(Duration(seconds: 3), () {
      Navigator.pushReplacement(
        context,
        MaterialPageRoute(builder: (context) => HomePage()),
      );
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: Colors.orange.shade800, // Turuncu arka plan
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            // Sahil Güvenlik Logosu - Simetrik ve ortalanmış
            Container(
              width: 150,
              height: 150,
              decoration: BoxDecoration(
                color: Colors.white,
                shape: BoxShape.circle,
                boxShadow: [
                  BoxShadow(
                    color: Colors.black26,
                    blurRadius: 15,
                    offset: Offset(0, 6),
                  ),
                ],
              ),
              child: ClipOval(
                child: Image.asset(
                  'assets/images/resim2.png',
                  width: 150,
                  height: 150,
                  fit: BoxFit.cover,
                  errorBuilder: (context, error, stackTrace) {
                    return Icon(
                      Icons.security,
                      size: 60,
                      color: Colors.orange.shade800,
                    );
                  },
                ),
              ),
            ),
            SizedBox(height: 40),
            // Sahil Güvenlik Yazısı
            Text(
              'SAHİL GÜVENLİK KOMUTANLIĞI',
              style: TextStyle(
                fontSize: 22,
                fontWeight: FontWeight.bold,
                color: Colors.white,
                letterSpacing: 1.5,
              ),
            ),
            SizedBox(height: 15),
            // SG-CEP Yazısı
            Text(
              'SG-CEP UYGULAMASI',
              style: TextStyle(
                fontSize: 28,
                fontWeight: FontWeight.w900,
                color: Colors.white,
                letterSpacing: 2.0,
              ),
            ),
            SizedBox(height: 40),
            // Yükleniyor İndikatörü
            CircularProgressIndicator(
              valueColor: AlwaysStoppedAnimation<Color>(Colors.white),
            ),
            SizedBox(height: 20),
            Text(
              'Yükleniyor...',
              style: TextStyle(fontSize: 16, color: Colors.white),
            ),
          ],
        ),
      ),
    );
  }
}

// ANA SAYFA
class HomePage extends StatefulWidget {
  const HomePage({super.key});

  @override
  State<HomePage> createState() => _HomePageState();
}

class _HomePageState extends State<HomePage> {
  final TextEditingController _searchController = TextEditingController();
  final FocusNode _searchFocusNode = FocusNode();
  bool _showSearchResults = false;
  List<Map<String, dynamic>> _searchResults = [];

  final List<Map<String, dynamic>> _allMenuItems = [
    {
      'title': 'Yasal İşlem Tutanakları',
      'icon': Icons.assignment,
      'color': Colors.blue,
      'page': YasalIslemTutanaklariPage(),
    },
    {
      'title': 'Kontrol Listeleri',
      'icon': Icons.assessment,
      'color': Colors.orange,
      'page': KontrolListeleriAnaPage(),
    },
    {
      'title': 'Mevzuat',
      'icon': Icons.gavel,
      'color': Colors.purple,
      'page': MevzuatPage(),
    },
    {
      'title': 'Sıkça Yapılan Hatalar',
      'icon': Icons.error_outline,
      'color': Colors.red,
      'page': SikcaYapilanHatalarPage(),
    },
    {
      'title': 'Duyurular',
      'icon': Icons.announcement,
      'color': Colors.teal,
      'page': DuyurularPage(),
    },
    {
      'title': 'Üye Girişi',
      'icon': Icons.login,
      'color': Colors.redAccent,
      'action': 'login',
    },
    {
      'title': 'Kayıt Ol',
      'icon': Icons.person_add,
      'color': Colors.green,
      'action': 'register',
    },
  ];

  @override
  void initState() {
    super.initState();
    _searchController.addListener(_onSearchChanged);
  }

  void _onSearchChanged() {
    final query = _searchController.text.toLowerCase();
    setState(() {
      _showSearchResults = query.isNotEmpty;
      if (query.isNotEmpty) {
        _searchResults = _allMenuItems.where((item) {
          return item['title'].toLowerCase().contains(query);
        }).toList();
      } else {
        _searchResults.clear();
      }
    });
  }

  void _onSearchItemTap(Map<String, dynamic> item) {
    if (item['page'] != null) {
      _navigateTo(context, item['page']);
    } else if (item['action'] == 'login') {
      _navigateToLogin(context);
    } else if (item['action'] == 'register') {
      _navigateToRegister(context);
    }

    setState(() {
      _showSearchResults = false;
      _searchController.clear();
      _searchFocusNode.unfocus();
    });
  }

  @override
  void dispose() {
    _searchController.dispose();
    _searchFocusNode.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('SG-CEP Ana Sayfa'),
        actions: _buildAppBarActions(context),
        elevation: 4,
        backgroundColor: Colors.orange.shade800,
      ),
      body: _buildBody(context),
    );
  }

  List<Widget> _buildAppBarActions(BuildContext context) {
    return [
      _buildAppBarButton('Üye Girişi', Icons.login, Colors.white, () {
        _navigateToLogin(context);
      }),
      SizedBox(width: 8),
      _buildAppBarButton('Kayıt Ol', Icons.person_add, Colors.white, () {
        _navigateToRegister(context);
      }),
    ];
  }

  Widget _buildAppBarButton(
    String text,
    IconData icon,
    Color color,
    VoidCallback onPressed,
  ) {
    return TextButton.icon(
      icon: Icon(icon, color: color, size: 20),
      label: Text(text, style: TextStyle(color: color, fontSize: 14)),
      onPressed: onPressed,
    );
  }

  Widget _buildBody(BuildContext context) {
    return Stack(
      children: [
        Column(
          children: [
            Container(
              decoration: BoxDecoration(
                gradient: LinearGradient(
                  colors: [Colors.orange.shade800, Colors.orange.shade600],
                  begin: Alignment.topLeft,
                  end: Alignment.bottomRight,
                ),
              ),
              child: Column(children: [_buildHeader(), _buildSearchField()]),
            ),
            Expanded(
              child: Container(
                decoration: BoxDecoration(
                  image: DecorationImage(
                    image: AssetImage('assets/images/resim1.jpg'),
                    fit: BoxFit.cover,
                    opacity: 0.7,
                  ),
                ),
                child: Column(
                  children: [
                    Expanded(child: _buildGridButtons(context)),
                    _buildDuyurular(),
                  ],
                ),
              ),
            ),
          ],
        ),
        if (_showSearchResults && _searchResults.isNotEmpty)
          Positioned(
            top: 200,
            left: 24,
            right: 24,
            child: _buildSearchResults(),
          ),
      ],
    );
  }

  Widget _buildHeader() {
    return Stack(
      alignment: Alignment.center,
      children: [
        Padding(
          padding: EdgeInsets.symmetric(vertical: 24, horizontal: 16),
          child: Row(
            mainAxisAlignment: MainAxisAlignment.center,
            crossAxisAlignment: CrossAxisAlignment.center,
            children: [
              Container(
                decoration: BoxDecoration(
                  color: Colors.white,
                  shape: BoxShape.circle,
                  boxShadow: [
                    BoxShadow(
                      color: Colors.black26,
                      blurRadius: 8,
                      offset: Offset(0, 2),
                    ),
                  ],
                ),
                padding: EdgeInsets.all(4),
                child: ClipOval(
                  child: Image.asset(
                    'assets/images/resim2.png',
                    width: 60,
                    height: 60,
                    fit: BoxFit.contain,
                    errorBuilder: (context, error, stackTrace) {
                      return Icon(
                        Icons.security,
                        size: 60,
                        color: Colors.orange,
                      );
                    },
                  ),
                ),
              ),
              SizedBox(width: 16),
              Expanded(
                child: Text(
                  'SG-CEP\nSAHİL GÜVENLİK EĞİTİM PLATFORMU',
                  style: TextStyle(
                    fontSize: 20,
                    fontWeight: FontWeight.bold,
                    color: Colors.white,
                    height: 1.3,
                    shadows: [
                      Shadow(
                        color: Colors.black87,
                        blurRadius: 10,
                        offset: Offset(2, 2),
                      ),
                    ],
                  ),
                  textAlign: TextAlign.center,
                ),
              ),
              SizedBox(width: 16),
              Container(
                decoration: BoxDecoration(
                  color: Colors.white,
                  shape: BoxShape.circle,
                  boxShadow: [
                    BoxShadow(
                      color: Colors.black26,
                      blurRadius: 8,
                      offset: Offset(0, 2),
                    ),
                  ],
                ),
                padding: EdgeInsets.all(4),
                child: ClipOval(
                  child: Image.asset(
                    'assets/images/resim2.png',
                    width: 60,
                    height: 60,
                    fit: BoxFit.contain,
                    errorBuilder: (context, error, stackTrace) {
                      return Icon(
                        Icons.security,
                        size: 60,
                        color: Colors.orange,
                      );
                    },
                  ),
                ),
              ),
            ],
          ),
        ),
      ],
    );
  }

  Widget _buildSearchField() {
    return Padding(
      padding: const EdgeInsets.symmetric(horizontal: 24.0, vertical: 16),
      child: Column(
        children: [
          TextField(
            controller: _searchController,
            focusNode: _searchFocusNode,
            decoration: InputDecoration(
              hintText:
                  'Menüde ara... (Tutanaklar, Kontrol Listeleri, Mevzuat vb.)',
              prefixIcon: Icon(Icons.search, color: Colors.orange.shade800),
              hintStyle: TextStyle(color: Colors.grey.shade600),
              filled: true,
              fillColor: Colors.white.withOpacity(0.9),
              border: OutlineInputBorder(
                borderRadius: BorderRadius.circular(12),
                borderSide: BorderSide.none,
              ),
            ),
          ),
        ],
      ),
    );
  }

  Widget _buildSearchResults() {
    return Material(
      elevation: 8,
      borderRadius: BorderRadius.circular(12),
      child: Container(
        decoration: BoxDecoration(
          color: Colors.white,
          borderRadius: BorderRadius.circular(12),
          boxShadow: [
            BoxShadow(
              color: Colors.black26,
              blurRadius: 10,
              offset: Offset(0, 4),
            ),
          ],
        ),
        constraints: BoxConstraints(maxHeight: 300),
        child: ListView.builder(
          shrinkWrap: true,
          padding: EdgeInsets.all(8),
          itemCount: _searchResults.length,
          itemBuilder: (context, index) {
            final item = _searchResults[index];
            return ListTile(
              leading: Icon(item['icon'], color: item['color']),
              title: Text(item['title']),
              trailing: Icon(
                Icons.arrow_forward_ios,
                size: 16,
                color: Colors.grey,
              ),
              onTap: () => _onSearchItemTap(item),
              shape: RoundedRectangleBorder(
                borderRadius: BorderRadius.circular(8),
              ),
            );
          },
        ),
      ),
    );
  }

  Widget _buildGridButtons(BuildContext context) {
    return Padding(
      padding: const EdgeInsets.all(20.0),
      child: GridView.count(
        crossAxisCount: 2,
        mainAxisSpacing: 16,
        crossAxisSpacing: 16,
        childAspectRatio: 1.3, // Daha dengeli boyut oranı
        children: [
          _buildGridItem(
            'Yasal İşlem Tutanakları',
            Icons.assignment,
            Colors.blue,
            () => _navigateTo(context, YasalIslemTutanaklariPage()),
          ),
          _buildGridItem(
            'Kontrol Listeleri',
            Icons.assessment,
            Colors.orange,
            () => _navigateTo(context, KontrolListeleriAnaPage()),
          ),
          _buildGridItem(
            'Mevzuat',
            Icons.gavel,
            Colors.purple,
            () => _navigateTo(context, MevzuatPage()),
          ),
          _buildGridItem(
            'Sıkça Yapılan Hatalar',
            Icons.error_outline,
            Colors.red,
            () => _navigateTo(context, SikcaYapilanHatalarPage()),
          ),
          _buildGridItem(
            'Duyurular',
            Icons.announcement,
            Colors.teal,
            () => _navigateTo(context, DuyurularPage()),
          ),
        ],
      ),
    );
  }

  Widget _buildGridItem(
    String title,
    IconData icon,
    Color color,
    VoidCallback onTap,
  ) {
    return Card(
      elevation: 6,
      color: Colors.transparent,
      shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(16)),
      child: InkWell(
        borderRadius: BorderRadius.circular(16),
        onTap: onTap,
        child: Container(
          decoration: BoxDecoration(
            borderRadius: BorderRadius.circular(16),
            color: Color.fromRGBO(255, 255, 255, 0.4),
            border: Border.all(color: Colors.white.withOpacity(0.7), width: 2),
          ),
          child: Column(
            mainAxisAlignment: MainAxisAlignment.center,
            children: [
              Container(
                padding: EdgeInsets.all(10),
                decoration: BoxDecoration(
                  color: Colors.white.withOpacity(0.9),
                  shape: BoxShape.circle,
                ),
                child: Icon(icon, size: 36, color: color),
              ),
              SizedBox(height: 12),
              Container(
                padding: EdgeInsets.symmetric(horizontal: 8, vertical: 6),
                constraints: BoxConstraints(maxWidth: 130),
                decoration: BoxDecoration(
                  color: Colors.white.withOpacity(0.9),
                  borderRadius: BorderRadius.circular(8),
                ),
                child: Text(
                  title,
                  style: TextStyle(
                    fontSize: _getTitleFontSize(title),
                    fontWeight: FontWeight.w600,
                    color: color,
                  ),
                  textAlign: TextAlign.center,
                  maxLines: 2,
                  overflow: TextOverflow.ellipsis,
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }

  double _getTitleFontSize(String title) {
    if (title.length > 15) return 12.0;
    if (title.length > 10) return 13.0;
    return 14.0;
  }

  Widget _buildDuyurular() {
    final List<Map<String, String>> duyurular = [
      {'text': 'Yeni tutanak formatları eklendi', 'date': '2025-01-15'},
      {'text': 'Mevzuat güncellemesi yayınlandı', 'date': '2025-01-10'},
      {'text': 'Kontrol listeleri güncellendi', 'date': '2025-01-05'},
    ];

    return Container(
      margin: EdgeInsets.all(16),
      padding: EdgeInsets.all(16),
      height: 120,
      decoration: BoxDecoration(
        color: Color.fromRGBO(255, 255, 255, 0.4),
        borderRadius: BorderRadius.circular(16),
        border: Border.all(color: Colors.white.withOpacity(0.7), width: 2),
        boxShadow: [
          BoxShadow(color: Colors.black12, blurRadius: 8, offset: Offset(0, 3)),
        ],
      ),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          Row(
            children: [
              Icon(Icons.announcement, color: Colors.white, size: 20),
              SizedBox(width: 8),
              Text(
                'Son Duyurular',
                style: TextStyle(
                  fontSize: 16,
                  fontWeight: FontWeight.bold,
                  color: Colors.white,
                  shadows: [
                    Shadow(
                      color: Colors.black87,
                      blurRadius: 4,
                      offset: Offset(1, 1),
                    ),
                  ],
                ),
              ),
            ],
          ),
          SizedBox(height: 12),
          Expanded(
            child: ListView.builder(
              shrinkWrap: true,
              physics: BouncingScrollPhysics(),
              itemCount: duyurular.length,
              itemBuilder: (context, index) {
                return _buildDuyuruItem(
                  duyurular[index]['text']!,
                  duyurular[index]['date']!,
                );
              },
            ),
          ),
        ],
      ),
    );
  }

  Widget _buildDuyuruItem(String text, String date) {
    return Padding(
      padding: EdgeInsets.symmetric(vertical: 4),
      child: Row(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          Padding(
            padding: EdgeInsets.only(top: 3),
            child: Icon(Icons.circle, size: 6, color: Colors.white),
          ),
          SizedBox(width: 6),
          Expanded(
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.start,
              children: [
                Text(
                  text,
                  style: TextStyle(
                    fontSize: 12,
                    color: Colors.white,
                    fontWeight: FontWeight.w500,
                    shadows: [
                      Shadow(
                        color: Colors.black87,
                        blurRadius: 4,
                        offset: Offset(1, 1),
                      ),
                    ],
                  ),
                  maxLines: 1,
                  overflow: TextOverflow.ellipsis,
                ),
                SizedBox(height: 1),
                Text(
                  date,
                  style: TextStyle(
                    fontSize: 10,
                    color: Colors.white.withOpacity(0.8),
                    shadows: [
                      Shadow(
                        color: Colors.black87,
                        blurRadius: 4,
                        offset: Offset(1, 1),
                      ),
                    ],
                  ),
                ),
              ],
            ),
          ),
        ],
      ),
    );
  }

  void _navigateTo(BuildContext context, Widget page) {
    Navigator.push(context, MaterialPageRoute(builder: (context) => page));
  }

  void _navigateToLogin(BuildContext context) {
    Navigator.push(
      context,
      MaterialPageRoute(builder: (context) => LoginPage()),
    );
  }

  void _navigateToRegister(BuildContext context) {
    Navigator.push(
      context,
      MaterialPageRoute(builder: (context) => RegisterPage()),
    );
  }
}

// B. YASAL İŞLEM TUTANAKLARI EKRANI
class YasalIslemTutanaklariPage extends StatelessWidget {
  final List<Map<String, dynamic>> tutanaklar = [
    {
      'title': 'Arama Kararı Tutanağı',
      'icon': Icons.search,
      'color': Colors.blue,
      'videoUrl': 'https://example.com/arama_karari.mp4',
      'imageUrl': 'assets/tutanaklar/arama_karari.jpg',
    },
    {
      'title': 'Arama Tutanağı',
      'icon': Icons.find_in_page,
      'color': Colors.blue.shade700,
      'videoUrl': 'https://example.com/arama_tutanagi.mp4',
      'imageUrl': 'assets/tutanaklar/arama_tutanagi.jpg',
    },
    {
      'title': 'Bilgi Alma Tutanağı',
      'icon': Icons.info,
      'color': Colors.green,
      'videoUrl': 'https://example.com/bilgi_alma.mp4',
      'imageUrl': 'assets/tutanaklar/bilgi_alma.jpg',
    },
    {
      'title': 'Genel Amaçlı Zapt (Elkoyma) Tutanağı',
      'icon': Icons.security,
      'color': Colors.orange,
      'videoUrl': 'https://example.com/elkoyma.mp4',
      'imageUrl': 'assets/tutanaklar/elkoyma.jpg',
    },
    {
      'title': 'Elkoyma ve Sevk Tutanağı (Gerçek Kişi)',
      'icon': Icons.person,
      'color': Colors.orange.shade700,
      'videoUrl': 'https://example.com/elkoyma_gercek.mp4',
      'imageUrl': 'assets/tutanaklar/elkoyma_gercek.jpg',
    },
    {
      'title': 'Elkoyma ve Sevk Tutanağı (Tüzel Kişi)',
      'icon': Icons.business,
      'color': Colors.orange.shade800,
      'videoUrl': 'https://example.com/elkoyma_tuzel.mp4',
      'imageUrl': 'assets/tutanaklar/elkoyma_tuzel.jpg',
    },
    {
      'title': 'Fezleke',
      'icon': Icons.description,
      'color': Colors.purple,
      'videoUrl': 'https://example.com/fezleke.mp4',
      'imageUrl': 'assets/tutanaklar/fezleke.jpg',
    },
    {
      'title': 'Gemi İdari Yaptırım Karar Tutanağı (Çevre)',
      'icon': Icons.directions_boat,
      'color': Colors.teal,
      'videoUrl': 'https://example.com/gemi_cevre.mp4',
      'imageUrl': 'assets/tutanaklar/gemi_cevre.jpg',
    },
    {
      'title': 'Genel Amaçlı Yediemine Teslim Tutanağı',
      'icon': Icons.handshake,
      'color': Colors.brown,
      'videoUrl': 'https://example.com/yediemin.mp4',
      'imageUrl': 'assets/tutanaklar/yediemin.jpg',
    },
    {
      'title': 'İdari Para Cezası Kararı (Su Ürünleri)',
      'icon': Icons.money_off,
      'color': Colors.red,
      'videoUrl': 'https://example.com/para_cezasi.mp4',
      'imageUrl': 'assets/tutanaklar/para_cezasi.jpg',
    },
    {
      'title': 'İdari Yaptırım Karar Tutanağı',
      'icon': Icons.gavel,
      'color': Colors.red.shade700,
      'videoUrl': 'https://example.com/idari_yaptirim.mp4',
      'imageUrl': 'assets/tutanaklar/idari_yaptirim.jpg',
    },
    {
      'title': 'Mağdur/Müşteki İfade Tutanağı',
      'icon': Icons.record_voice_over,
      'color': Colors.pink,
      'videoUrl': 'https://example.com/magdur_ifade.mp4',
      'imageUrl': 'assets/tutanaklar/magdur_ifade.jpg',
    },
    {
      'title': 'Numune Tutanağı (Çevre)',
      'icon': Icons.science,
      'color': Colors.green.shade700,
      'videoUrl': 'https://example.com/numune.mp4',
      'imageUrl': 'assets/tutanaklar/numune.jpg',
    },
    {
      'title': 'Olay Tespit Tutanağı',
      'icon': Icons.warning,
      'color': Colors.amber,
      'videoUrl': 'https://example.com/olay_tespit.mp4',
      'imageUrl': 'assets/tutanaklar/olay_tespit.jpg',
    },
    {
      'title': 'Sanık Karar Takip Formu',
      'icon': Icons.track_changes,
      'color': Colors.deepOrange,
      'videoUrl': 'https://example.com/sanik_takip.mp4',
      'imageUrl': 'assets/tutanaklar/sanik_takip.jpg',
    },
    {
      'title': 'Savcılık Görüşme Tutanağı',
      'icon': Icons.people,
      'color': Colors.purple.shade700,
      'videoUrl': 'https://example.com/savcilik.mp4',
      'imageUrl': 'assets/tutanaklar/savcilik.jpg',
    },
    {
      'title': 'Sevk Serbest Bırakma Tutanağı',
      'icon': Icons.exit_to_app,
      'color': Colors.green.shade800,
      'videoUrl': 'https://example.com/sevk_serbest.mp4',
      'imageUrl': 'assets/tutanaklar/sevk_serbest.jpg',
    },
    {
      'title': 'Su Ürünleri Kanununa Aykırılıklara İlişkin Tespit Tutanağı',
      'icon': Icons.water_damage,
      'color': Colors.blue.shade900,
      'videoUrl': 'https://example.com/su_urunleri_tespit.mp4',
      'imageUrl': 'assets/tutanaklar/su_urunleri_tespit.jpg',
    },
    {
      'title': 'Şüpheli İfade Tutanağı (Müdafi Talep Edildiğinde)',
      'icon': Icons.person_pin,
      'color': Colors.red.shade900,
      'videoUrl': 'https://example.com/supheli_mudafi.mp4',
      'imageUrl': 'assets/tutanaklar/supheli_mudafi.jpg',
    },
    {
      'title': 'Şüpheli İfade Tutanağı (Müdafi Talep Edilmediğinde)',
      'icon': Icons.person_outline,
      'color': Colors.red.shade800,
      'videoUrl': 'https://example.com/supheli_mudafisiz.mp4',
      'imageUrl': 'assets/tutanaklar/supheli_mudafisiz.jpg',
    },
    {
      'title': 'Tespit Tutanağı (Çevre)',
      'icon': Icons.eco,
      'color': Colors.lightGreen,
      'videoUrl': 'https://example.com/tespit_cevre.mp4',
      'imageUrl': 'assets/tutanaklar/tespit_cevre.jpg',
    },
    {
      'title': 'Teşhis Tutanağı',
      'icon': Icons.visibility,
      'color': Colors.cyan,
      'videoUrl': 'https://example.com/teshis.mp4',
      'imageUrl': 'assets/tutanaklar/teshis.jpg',
    },
    {
      'title': 'Tutanak ve Tebligat (Su Ürünleri)',
      'icon': Icons.notifications,
      'color': Colors.blueGrey,
      'videoUrl': 'https://example.com/tebligat.mp4',
      'imageUrl': 'assets/tutanaklar/tebligat.jpg',
    },
    {
      'title': 'Üst Arama Tutanağı',
      'icon': Icons.person_search,
      'color': Colors.deepPurple,
      'videoUrl': 'https://example.com/ust_arama.mp4',
      'imageUrl': 'assets/tutanaklar/ust_arama.jpg',
    },
    {
      'title': 'Yakalama ve Gözaltına Alma Tutanağı',
      'icon': Icons.lock,
      'color': Colors.red.shade600,
      'videoUrl': 'https://example.com/yakalama.mp4',
      'imageUrl': 'assets/tutanaklar/yakalama.jpg',
    },
    {
      'title': 'Şüpheli ve Sanık Hakları Formu',
      'icon': Icons.article,
      'color': Colors.indigo,
      'videoUrl': 'https://example.com/haklar_formu.mp4',
      'imageUrl': 'assets/tutanaklar/haklar_formu.jpg',
    },
    {
      'title': 'Zaptetme (Elkoyma) Tutanağı (Su Ürünleri)',
      'icon': Icons.beach_access,
      'color': Colors.lightBlue,
      'videoUrl': 'https://example.com/zaptetme_su_urunleri.mp4',
      'imageUrl': 'assets/tutanaklar/zaptetme_su_urunleri.jpg',
    },
  ];

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Yasal İşlem Tutanakları'),
        backgroundColor: Colors.blue.shade800,
        elevation: 4,
      ),
      body: ListView.builder(
        itemCount: tutanaklar.length,
        itemBuilder: (context, index) {
          final tutanak = tutanaklar[index];
          return Card(
            margin: EdgeInsets.symmetric(horizontal: 16, vertical: 8),
            elevation: 3,
            shape: RoundedRectangleBorder(
              borderRadius: BorderRadius.circular(12),
            ),
            child: ListTile(
              leading: Container(
                padding: EdgeInsets.all(8),
                decoration: BoxDecoration(
                  color: tutanak['color'].withOpacity(0.1),
                  shape: BoxShape.circle,
                ),
                child: Icon(tutanak['icon'], color: tutanak['color']),
              ),
              title: Text(
                tutanak['title'],
                style: TextStyle(fontWeight: FontWeight.w600),
              ),
              subtitle: Text('Video ve örnek tutanak görüntüleri'),
              trailing: Row(
                mainAxisSize: MainAxisSize.min,
                children: [
                  IconButton(
                    icon: Icon(Icons.ondemand_video, color: Colors.blue),
                    onPressed: () {
                      _showVideoDialog(
                        context,
                        tutanak['title'],
                        tutanak['videoUrl'],
                      );
                    },
                  ),
                  IconButton(
                    icon: Icon(Icons.image, color: Colors.green),
                    onPressed: () {
                      _showImageDialog(
                        context,
                        tutanak['title'],
                        tutanak['imageUrl'],
                      );
                    },
                  ),
                ],
              ),
              onTap: () {
                _showTutanakOptions(context, tutanak);
              },
            ),
          );
        },
      ),
    );
  }

  void _showVideoDialog(BuildContext context, String title, String videoUrl) {
    showDialog(
      context: context,
      builder: (context) => AlertDialog(
        title: Text('$title - Video Eğitimi'),
        content: Column(
          mainAxisSize: MainAxisSize.min,
          children: [
            Icon(Icons.ondemand_video, size: 60, color: Colors.blue),
            SizedBox(height: 16),
            Text('Video eğitim içeriği yükleniyor...'),
            SizedBox(height: 16),
            LinearProgressIndicator(),
          ],
        ),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context),
            child: Text('Kapat'),
          ),
        ],
      ),
    );
  }

  void _showImageDialog(BuildContext context, String title, String imageUrl) {
    showDialog(
      context: context,
      builder: (context) => AlertDialog(
        title: Text('$title - Örnek Tutanak'),
        content: Column(
          mainAxisSize: MainAxisSize.min,
          children: [
            Container(
              width: 200,
              height: 150,
              decoration: BoxDecoration(
                color: Colors.grey.shade200,
                borderRadius: BorderRadius.circular(8),
                border: Border.all(color: Colors.grey.shade300),
              ),
              child: Icon(
                Icons.description,
                size: 60,
                color: Colors.grey.shade400,
              ),
            ),
            SizedBox(height: 16),
            Text('Örnek tutanak görüntüsü'),
          ],
        ),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context),
            child: Text('Kapat'),
          ),
        ],
      ),
    );
  }

  void _showTutanakOptions(BuildContext context, Map<String, dynamic> tutanak) {
    showModalBottomSheet(
      context: context,
      builder: (context) => Container(
        padding: EdgeInsets.all(16),
        child: Column(
          mainAxisSize: MainAxisSize.min,
          children: [
            Text(
              tutanak['title'],
              style: TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
            ),
            SizedBox(height: 16),
            ListTile(
              leading: Icon(Icons.ondemand_video, color: Colors.blue),
              title: Text('Video Eğitimi İzle'),
              onTap: () {
                Navigator.pop(context);
                _showVideoDialog(
                  context,
                  tutanak['title'],
                  tutanak['videoUrl'],
                );
              },
            ),
            ListTile(
              leading: Icon(Icons.image, color: Colors.green),
              title: Text('Örnek Tutanak Görüntüsü'),
              onTap: () {
                Navigator.pop(context);
                _showImageDialog(
                  context,
                  tutanak['title'],
                  tutanak['imageUrl'],
                );
              },
            ),
            ListTile(
              leading: Icon(Icons.download, color: Colors.purple),
              title: Text('PDF Formatında İndir'),
              onTap: () {
                Navigator.pop(context);
                ScaffoldMessenger.of(context).showSnackBar(
                  SnackBar(content: Text('${tutanak['title']} indiriliyor...')),
                );
              },
            ),
          ],
        ),
      ),
    );
  }
}

// C. KONTROL LİSTELERİ ANA EKRANI
class KontrolListeleriAnaPage extends StatelessWidget {
  final List<Map<String, dynamic>> anaKategoriler = [
    {
      'title': 'Ticari Amaçlı Gemiler İçin Genel Kontrol Listeleri',
      'icon': Icons.directions_boat,
      'color': Colors.blue,
      'subItems': [
        'Gemi Genel Kontrol Listesi',
        'Güvenlik Ekipmanları Kontrol Listesi',
        'Seyir Dokümanları Kontrol Listesi',
      ],
    },
    {
      'title': 'Özel Tekne Kontrol Listesi',
      'icon': Icons.sailing,
      'color': Colors.green,
      'subItems': [
        'Özel Tekne Genel Kontrol',
        'Güvenlik Ekipmanları',
        'Seyir Evrakları Kontrolü',
      ],
    },
    {
      'title': 'Su Ürünleri Avcılığı Kontrol Listeleri',
      'icon': Icons.water,
      'color': Colors.teal,
      'subItems': [
        'Trol Yöntemi Kontrol Listesi',
        'Gırgır Yöntemi Kontrol Listesi',
        'Algarna Yöntemi Kontrol Listesi',
        'Parakete Yöntemi Kontrol Listesi',
        'Uzatma Ağları Kontrol Listesi',
        'Sualtı Tüfeği/Patlayıcı Madde Kontrol Listesi',
        'Yabancı Bayraklı Balıkçı Tekneleri Kontrol Listesi',
        'Türk Bayraklı Balıkçı Tekneleri Yurt Dışı Kontrol Listesi',
        'Amatör Balıkçılık Kontrol Listesi',
        'ICCAT Kontrol Listesi',
        'Gürcistan Deniz Yetki Alanı Kontrol Listesi',
        'Uluslararası Sular Kontrol Listesi',
      ],
    },
    {
      'title':
          'Sualtı Sporları, Ticari/Amatör Dalış Faaliyetleri Kontrol Listeleri',
      'icon': Icons.scuba_diving,
      'color': Colors.purple,
      'subItems': [
        'Ticari Dalış İşletmeleri Kontrol Listesi',
        'Amatör Dalış Faaliyetleri Kontrol Listesi',
        'Dalış Ekipmanları Kontrol Listesi',
      ],
    },
    {
      'title': 'Suüstü Sporları İşletmeleri Kontrol Listesi',
      'icon': Icons.surfing,
      'color': Colors.orange,
      'subItems': [
        'Su Kayağı İşletmeleri Kontrol Listesi',
        'Jet Ski İşletmeleri Kontrol Listesi',
        'Yat İşletmeleri Kontrol Listesi',
      ],
    },
    {
      'title': 'Balık Çiftlikleri Kontrol Listeleri',
      'icon': Icons.agriculture,
      'color': Colors.brown,
      'subItems': [
        'Balık Çiftliği Genel Kontrol Listesi',
        'Çevresel Etki Kontrol Listesi',
        'Üretim ve İşletme Kontrol Listesi',
      ],
    },
    {
      'title': 'Çevre Kanunu Kontrol Listesi',
      'icon': Icons.eco,
      'color': Colors.lightGreen,
      'subItems': [
        'Çevre Mevzuatı Uyum Kontrol Listesi',
        'Atık Yönetimi Kontrol Listesi',
        'Kirlilik Önleme Kontrol Listesi',
      ],
    },
    {
      'title': 'Kaçakçılıkla Mücadele Kontrol Listeleri',
      'icon': Icons.security,
      'color': Colors.red,
      'subItems': [
        'Gemi Kaçakçılık Kontrol Listesi',
        'Kara Bağlantılı Kaçakçılık Kontrol Listesi',
        'Önleyici Kontrol Listesi',
      ],
    },
  ];

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Kontrol Listeleri'),
        backgroundColor: Colors.orange.shade800,
        elevation: 4,
      ),
      body: ListView.builder(
        itemCount: anaKategoriler.length,
        itemBuilder: (context, index) {
          final kategori = anaKategoriler[index];
          return Card(
            margin: EdgeInsets.symmetric(horizontal: 16, vertical: 8),
            elevation: 3,
            shape: RoundedRectangleBorder(
              borderRadius: BorderRadius.circular(12),
            ),
            child: ListTile(
              leading: Container(
                padding: EdgeInsets.all(8),
                decoration: BoxDecoration(
                  color: kategori['color'].withOpacity(0.1),
                  shape: BoxShape.circle,
                ),
                child: Icon(kategori['icon'], color: kategori['color']),
              ),
              title: Text(
                kategori['title'],
                style: TextStyle(fontWeight: FontWeight.w600),
              ),
              subtitle: Text('${kategori['subItems'].length} alt kategori'),
              trailing: Icon(Icons.arrow_forward_ios, size: 16),
              onTap: () {
                _showAltKategoriler(context, kategori);
              },
            ),
          );
        },
      ),
    );
  }

  void _showAltKategoriler(
    BuildContext context,
    Map<String, dynamic> kategori,
  ) {
    showModalBottomSheet(
      context: context,
      isScrollControlled: true,
      builder: (context) => Container(
        padding: EdgeInsets.all(16),
        height: MediaQuery.of(context).size.height * 0.8,
        child: Column(
          children: [
            Text(
              kategori['title'],
              style: TextStyle(fontSize: 20, fontWeight: FontWeight.bold),
              textAlign: TextAlign.center,
            ),
            SizedBox(height: 16),
            Expanded(
              child: ListView.builder(
                itemCount: kategori['subItems'].length,
                itemBuilder: (context, index) {
                  return Card(
                    margin: EdgeInsets.symmetric(vertical: 4),
                    child: ListTile(
                      leading: Icon(Icons.checklist, color: kategori['color']),
                      title: Text(kategori['subItems'][index]),
                      trailing: Icon(Icons.visibility, color: Colors.grey),
                      onTap: () {
                        _showKontrolListesiDetay(
                          context,
                          kategori['subItems'][index],
                        );
                      },
                    ),
                  );
                },
              ),
            ),
            SizedBox(height: 16),
            ElevatedButton(
              onPressed: () => Navigator.pop(context),
              child: Text('Kapat'),
            ),
          ],
        ),
      ),
    );
  }

  void _showKontrolListesiDetay(BuildContext context, String listeAdi) {
    showDialog(
      context: context,
      builder: (context) => AlertDialog(
        title: Text(listeAdi),
        content: Container(
          width: double.maxFinite,
          child: ListView(
            shrinkWrap: true,
            children: [
              _buildKontrolMaddesi('1. Genel Görünüm Kontrolü', false),
              _buildKontrolMaddesi('2. Güvenlik Ekipmanları', false),
              _buildKontrolMaddesi('3. Seyir Dokümanları', false),
              _buildKontrolMaddesi('4. İzin ve Lisanslar', false),
              _buildKontrolMaddesi('5. Mürettebat Evrakları', false),
              _buildKontrolMaddesi('6. Çevre Uygunluk Kontrolü', false),
            ],
          ),
        ),
        actions: [
          TextButton(
            onPressed: () => Navigator.pop(context),
            child: Text('Kapat'),
          ),
          ElevatedButton(
            onPressed: () {
              Navigator.pop(context);
              ScaffoldMessenger.of(context).showSnackBar(
                SnackBar(content: Text('$listeAdi PDF olarak indiriliyor...')),
              );
            },
            child: Text('PDF İndir'),
          ),
        ],
      ),
    );
  }

  Widget _buildKontrolMaddesi(String madde, bool isChecked) {
    return CheckboxListTile(
      title: Text(madde),
      value: isChecked,
      onChanged: (bool? value) {},
      controlAffinity: ListTileControlAffinity.leading,
    );
  }
}

// D. MEVZUAT EKRANI
class MevzuatPage extends StatelessWidget {
  final List<Map<String, dynamic>> mevzuatListesi = [
    {
      'title': 'Türk Ceza Kanunu',
      'url':
          'https://www.mevzuat.gov.tr/mevzuat?MevzuatNo=5237&MevzuatTur=1&MevzuatTertip=5',
    },
    {
      'title': 'Ceza Muhakemesi Kanunu',
      'url':
          'https://www.mevzuat.gov.tr/mevzuat?MevzuatNo=5271&MevzuatTur=1&MevzuatTertip=5',
    },
    {
      'title': 'Kabahatler Kanunu',
      'url':
          'https://www.mevzuat.gov.tr/mevzuat?MevzuatNo=5326&MevzuatTur=1&MevzuatTertip=5',
    },
    {
      'title': 'Sahil Güvenlik Kanunu',
      'url':
          'https://www.mevzuat.gov.tr/mevzuat?MevzuatNo=2692&MevzuatTur=1&MevzuatTertip=5',
    },
    {
      'title': 'Deniz Çevresinin Korunması Kanunu',
      'url':
          'https://www.mevzuat.gov.tr/mevzuat?MevzuatNo=5312&MevzuatTur=1&MevzuatTertip=5',
    },
    {
      'title': 'Su Ürünleri Kanunu',
      'url':
          'https://www.mevzuat.gov.tr/mevzuat?MevzuatNo=1380&MevzuatTur=1&MevzuatTertip=5',
    },
    {
      'title': 'Gemi Adamları Kanunu',
      'url':
          'https://www.mevzuat.gov.tr/mevzuat?MevzuatNo=854&MevzuatTur=1&MevzuatTertip=5',
    },
    {
      'title': 'Türk Bayrağının Çekilmesi ve Kullanılması Hakkında Kanun',
      'url':
          'https://www.mevzuat.gov.tr/mevzuat?MevzuatNo=2893&MevzuatTur=1&MevzuatTertip=5',
    },
    {
      'title': 'Sahil Güvenlik Yönetmeliği',
      'url':
          'https://www.mevzuat.gov.tr/mevzuat?MevzuatNo=20230&MevzuatTur=7&MevzuatTertip=5',
    },
    {
      'title': 'Deniz Çevresinin Korunması Yönetmeliği',
      'url':
          'https://www.mevzuat.gov.tr/mevzuat?MevzuatNo=20283&MevzuatTur=7&MevzuatTertip=5',
    },
  ];

  Future<void> _launchUrl(String url) async {
    final Uri uri = Uri.parse(url);
    if (!await launchUrl(uri)) {
      throw Exception('Could not launch $url');
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Mevzuat'),
        backgroundColor: Colors.purple.shade800,
        elevation: 4,
      ),
      body: ListView.builder(
        itemCount: mevzuatListesi.length,
        itemBuilder: (context, index) {
          final mevzuat = mevzuatListesi[index];
          return Card(
            margin: EdgeInsets.symmetric(horizontal: 16, vertical: 8),
            elevation: 3,
            shape: RoundedRectangleBorder(
              borderRadius: BorderRadius.circular(12),
            ),
            child: ListTile(
              leading: Container(
                padding: EdgeInsets.all(8),
                decoration: BoxDecoration(
                  color: Colors.purple.withOpacity(0.1),
                  shape: BoxShape.circle,
                ),
                child: Icon(Icons.gavel, color: Colors.purple),
              ),
              title: Text(
                mevzuat['title'],
                style: TextStyle(fontWeight: FontWeight.w600),
              ),
              trailing: Icon(Icons.open_in_new, color: Colors.blue),
              onTap: () => _launchUrl(mevzuat['url']),
            ),
          );
        },
      ),
      floatingActionButton: Column(
        mainAxisAlignment: MainAxisAlignment.end,
        children: [
          FloatingActionButton.extended(
            onPressed: () => _launchUrl('https://www.mevzuat.gov.tr'),
            icon: Icon(Icons.library_books),
            label: Text('Mevzuat.gov.tr'),
            backgroundColor: Colors.blue,
          ),
          SizedBox(height: 16),
          FloatingActionButton.extended(
            onPressed: () => _launchUrl('https://www.resmigazete.gov.tr'),
            icon: Icon(Icons.article),
            label: Text('Resmi Gazete'),
            backgroundColor: Colors.red,
          ),
        ],
      ),
    );
  }
}

// E. SIKÇA YAPILAN HATALAR EKRANI
class SikcaYapilanHatalarPage extends StatelessWidget {
  final List<Map<String, dynamic>> hatalar = [
    {
      'title': 'Eksik veya Yanlış Kimlik Bilgileri',
      'description':
          'Tutanaklarda kimlik bilgilerinin eksik veya yanlış doldurulması',
      'cozum':
          'TCKN, adres ve iletişim bilgileri dikkatlice kontrol edilmelidir.',
      'onem': 'Yüksek',
    },
    {
      'title': 'Zaman ve Tarih Hataları',
      'description': 'Tutanaklarda zaman ve tarih bilgilerinin tutarsız olması',
      'cozum': 'Tutanak başlangıç ve bitiş saatleri tutarlı olmalıdır.',
      'onem': 'Orta',
    },
    {
      'title': 'Mevzuat Maddelerinin Eksik Belirtilmesi',
      'description':
          'İşlemin dayanağı olan mevzuat maddelerinin belirtilmemesi',
      'cozum':
          'Her işlem için ilgili kanun ve madde numaraları belirtilmelidir.',
      'onem': 'Yüksek',
    },
    {
      'title': 'İmza Eksiklikleri',
      'description': 'Tutanaklarda gerekli imzaların atılmaması',
      'cozum': 'Tüm ilgili tarafların imzaları mutlaka alınmalıdır.',
      'onem': 'Kritik',
    },
    {
      'title': 'Delil Zinciri İhlali',
      'description': 'El konulan eşyalarda delil zincirinin bozulması',
      'cozum':
          'El konulan her eşya için ayrı tutanak düzenlenmeli ve zincir korunmalıdır.',
      'onem': 'Kritik',
    },
    {
      'title': 'Hakların Hatırlatılmaması',
      'description': 'Şüphelilere haklarının hatırlatılmaması',
      'cozum':
          'Her şüpheliye hakları yazılı ve sözlü olarak hatırlatılmalıdır.',
      'onem': 'Yüksek',
    },
    {
      'title': 'Coğrafi Koordinat Eksikliği',
      'description': 'Olay yerinin coğrafi koordinatlarının belirtilmemesi',
      'cozum': 'Tüm olay tutanaklarında GPS koordinatları belirtilmelidir.',
      'onem': 'Orta',
    },
    {
      'title': 'Tanık İfadelerinin Eksik Alınması',
      'description': 'Olay yerindeki tanıkların ifadelerinin alınmaması',
      'cozum':
          'Mümkün olan tüm tanıkların ifadeleri ayrıntılı şekilde alınmalıdır.',
      'onem': 'Yüksek',
    },
  ];

  Color _getOnemRengi(String onem) {
    switch (onem) {
      case 'Kritik':
        return Colors.red;
      case 'Yüksek':
        return Colors.orange;
      case 'Orta':
        return Colors.yellow.shade700;
      default:
        return Colors.grey;
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Sıkça Yapılan Hatalar'),
        backgroundColor: Colors.red.shade800,
        elevation: 4,
      ),
      body: ListView.builder(
        itemCount: hatalar.length,
        itemBuilder: (context, index) {
          final hata = hatalar[index];
          return Card(
            margin: EdgeInsets.symmetric(horizontal: 16, vertical: 8),
            elevation: 3,
            shape: RoundedRectangleBorder(
              borderRadius: BorderRadius.circular(12),
            ),
            child: ExpansionTile(
              leading: Container(
                padding: EdgeInsets.all(8),
                decoration: BoxDecoration(
                  color: _getOnemRengi(hata['onem']).withOpacity(0.1),
                  shape: BoxShape.circle,
                ),
                child: Icon(
                  Icons.error_outline,
                  color: _getOnemRengi(hata['onem']),
                ),
              ),
              title: Text(
                hata['title'],
                style: TextStyle(fontWeight: FontWeight.w600),
              ),
              subtitle: Row(
                children: [
                  Container(
                    padding: EdgeInsets.symmetric(horizontal: 8, vertical: 2),
                    decoration: BoxDecoration(
                      color: _getOnemRengi(hata['onem']).withOpacity(0.2),
                      borderRadius: BorderRadius.circular(4),
                      border: Border.all(color: _getOnemRengi(hata['onem'])),
                    ),
                    child: Text(
                      hata['onem'],
                      style: TextStyle(
                        fontSize: 12,
                        color: _getOnemRengi(hata['onem']),
                        fontWeight: FontWeight.bold,
                      ),
                    ),
                  ),
                ],
              ),
              children: [
                Padding(
                  padding: EdgeInsets.all(16),
                  child: Column(
                    crossAxisAlignment: CrossAxisAlignment.start,
                    children: [
                      Text(
                        'Hata:',
                        style: TextStyle(
                          fontWeight: FontWeight.bold,
                          color: Colors.red,
                        ),
                      ),
                      Text(hata['description']),
                      SizedBox(height: 8),
                      Text(
                        'Çözüm:',
                        style: TextStyle(
                          fontWeight: FontWeight.bold,
                          color: Colors.green,
                        ),
                      ),
                      Text(hata['cozum']),
                    ],
                  ),
                ),
              ],
            ),
          );
        },
      ),
    );
  }
}

// F. DUYURULAR EKRANI
class DuyurularPage extends StatelessWidget {
  final List<Map<String, dynamic>> duyurular = [
    {
      'title': 'Yeni Tutanak Formatları Yayınlandı',
      'date': '2025-01-15',
      'content':
          '01.01.2025 tarihi itibariyle tüm yasal işlem tutanaklarında yeni formatlar kullanılacaktır. Lütfen güncel tutanak formatlarını indiriniz.',
      'onem': 'Yüksek',
      'link': 'https://www.sg.gov.tr/duyurular/yeni_tutanak_formatlari',
    },
    {
      'title': 'Mevzuat Güncellemesi',
      'date': '2025-01-10',
      'content':
          'Su Ürünleri Kanununda değişiklik yapan 7334 sayılı kanun yayınlanmıştır. İlgili mevzuat sayfasından detaylara ulaşabilirsiniz.',
      'onem': 'Orta',
      'link': 'https://www.mevzuat.gov.tr/mevzuat?MevzuatNo=7334',
    },
    {
      'title': 'Kontrol Listeleri Güncellendi',
      'date': '2025-01-05',
      'content':
          'Ticari gemiler için genel kontrol listeleri güncellenmiştir. Yeni kontroller eklenmiş olup, eski listeler geçersizdir.',
      'onem': 'Yüksek',
      'link': 'https://www.sg.gov.tr/kontrol_listeleri',
    },
    {
      'title': 'Eğitim Programı Duyurusu',
      'date': '2024-12-28',
      'content':
          '2025 yılı ilk çeyrek eğitim programı yayınlanmıştır. Eğitim takvimini kurum içi portalınızdan takip edebilirsiniz.',
      'onem': 'Düşük',
      'link': null,
    },
    {
      'title': 'Sistem Bakımı',
      'date': '2024-12-20',
      'content':
          '15 Ocak 2025 tarihinde 02:00 - 06:00 saatleri arasında sistem bakımı yapılacaktır. Bu sürede uygulama kullanılamayacaktır.',
      'onem': 'Orta',
      'link': null,
    },
  ];

  Color _getOnemRengi(String onem) {
    switch (onem) {
      case 'Yüksek':
        return Colors.red;
      case 'Orta':
        return Colors.orange;
      case 'Düşük':
        return Colors.green;
      default:
        return Colors.grey;
    }
  }

  Future<void> _launchUrl(String? url) async {
    if (url != null) {
      final Uri uri = Uri.parse(url);
      if (!await launchUrl(uri)) {
        throw Exception('Could not launch $url');
      }
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Duyurular'),
        backgroundColor: Colors.teal.shade800,
        elevation: 4,
      ),
      body: ListView.builder(
        itemCount: duyurular.length,
        itemBuilder: (context, index) {
          final duyuru = duyurular[index];
          return Card(
            margin: EdgeInsets.symmetric(horizontal: 16, vertical: 8),
            elevation: 3,
            shape: RoundedRectangleBorder(
              borderRadius: BorderRadius.circular(12),
            ),
            child: ExpansionTile(
              leading: Container(
                padding: EdgeInsets.all(8),
                decoration: BoxDecoration(
                  color: _getOnemRengi(duyuru['onem']).withOpacity(0.1),
                  shape: BoxShape.circle,
                ),
                child: Icon(
                  Icons.announcement,
                  color: _getOnemRengi(duyuru['onem']),
                ),
              ),
              title: Text(
                duyuru['title'],
                style: TextStyle(fontWeight: FontWeight.w600),
              ),
              subtitle: Row(
                children: [
                  Text(duyuru['date']),
                  SizedBox(width: 8),
                  Container(
                    padding: EdgeInsets.symmetric(horizontal: 8, vertical: 2),
                    decoration: BoxDecoration(
                      color: _getOnemRengi(duyuru['onem']).withOpacity(0.2),
                      borderRadius: BorderRadius.circular(4),
                      border: Border.all(color: _getOnemRengi(duyuru['onem'])),
                    ),
                    child: Text(
                      duyuru['onem'],
                      style: TextStyle(
                        fontSize: 12,
                        color: _getOnemRengi(duyuru['onem']),
                        fontWeight: FontWeight.bold,
                      ),
                    ),
                  ),
                ],
              ),
              children: [
                Padding(
                  padding: EdgeInsets.all(16),
                  child: Column(
                    crossAxisAlignment: CrossAxisAlignment.start,
                    children: [
                      Text(duyuru['content']),
                      if (duyuru['link'] != null) ...[
                        SizedBox(height: 12),
                        ElevatedButton.icon(
                          onPressed: () => _launchUrl(duyuru['link']),
                          icon: Icon(Icons.open_in_new),
                          label: Text('Detaylı Bilgi'),
                          style: ElevatedButton.styleFrom(
                            backgroundColor: Colors.blue,
                          ),
                        ),
                      ],
                    ],
                  ),
                ),
              ],
            ),
          );
        },
      ),
    );
  }
}

// GİRİŞ ve KAYIT SAYFALARI
class LoginPage extends StatefulWidget {
  const LoginPage({super.key});
  @override
  State<LoginPage> createState() => _LoginPageState();
}

class _LoginPageState extends State<LoginPage> {
  final _formKey = GlobalKey<FormState>();
  final _usernameController = TextEditingController();
  final _passwordController = TextEditingController();
  bool _rememberMe = false;
  bool _obscurePassword = true;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Üye Girişi'),
        backgroundColor: Colors.orange.shade800,
      ),
      body: Container(
        decoration: BoxDecoration(
          gradient: LinearGradient(
            colors: [Colors.orange.shade50, Colors.amber.shade50],
            begin: Alignment.topLeft,
            end: Alignment.bottomRight,
          ),
        ),
        child: Center(
          child: SingleChildScrollView(
            padding: EdgeInsets.all(24),
            child: Card(
              elevation: 8,
              shape: RoundedRectangleBorder(
                borderRadius: BorderRadius.circular(16),
              ),
              child: Padding(
                padding: EdgeInsets.all(32),
                child: Form(
                  key: _formKey,
                  child: Column(
                    mainAxisSize: MainAxisSize.min,
                    children: [
                      Container(
                        width: 80,
                        height: 80,
                        decoration: BoxDecoration(
                          color: Colors.orange.shade100,
                          shape: BoxShape.circle,
                        ),
                        child: Icon(
                          Icons.security,
                          size: 40,
                          color: Colors.orange.shade800,
                        ),
                      ),
                      SizedBox(height: 24),
                      Text(
                        'Giriş Yap',
                        style: TextStyle(
                          fontSize: 28,
                          fontWeight: FontWeight.bold,
                          color: Colors.orange.shade800,
                        ),
                      ),
                      SizedBox(height: 8),
                      Text(
                        'Hesabınıza erişmek için giriş yapın',
                        style: TextStyle(
                          fontSize: 16,
                          color: Colors.grey.shade600,
                        ),
                      ),
                      SizedBox(height: 32),
                      TextFormField(
                        controller: _usernameController,
                        decoration: InputDecoration(
                          labelText: 'Kullanıcı Adı',
                          prefixIcon: Icon(Icons.person),
                          border: OutlineInputBorder(
                            borderRadius: BorderRadius.circular(12),
                          ),
                        ),
                        validator: (value) => value == null || value.isEmpty
                            ? 'Lütfen kullanıcı adınızı giriniz'
                            : null,
                      ),
                      SizedBox(height: 20),
                      TextFormField(
                        controller: _passwordController,
                        obscureText: _obscurePassword,
                        decoration: InputDecoration(
                          labelText: 'Şifre',
                          prefixIcon: Icon(Icons.lock),
                          suffixIcon: IconButton(
                            icon: Icon(
                              _obscurePassword
                                  ? Icons.visibility
                                  : Icons.visibility_off,
                            ),
                            onPressed: () => setState(
                              () => _obscurePassword = !_obscurePassword,
                            ),
                          ),
                          border: OutlineInputBorder(
                            borderRadius: BorderRadius.circular(12),
                          ),
                        ),
                        validator: (value) {
                          if (value == null || value.isEmpty)
                            return 'Lütfen şifrenizi giriniz';
                          if (value.length < 6)
                            return 'Şifre en az 6 karakter olmalıdır';
                          return null;
                        },
                      ),
                      SizedBox(height: 20),
                      Row(
                        mainAxisAlignment: MainAxisAlignment.spaceBetween,
                        children: [
                          Row(
                            children: [
                              Checkbox(
                                value: _rememberMe,
                                onChanged: (value) =>
                                    setState(() => _rememberMe = value!),
                              ),
                              Text('Beni Hatırla'),
                            ],
                          ),
                          TextButton(
                            onPressed: () {
                              ScaffoldMessenger.of(context).showSnackBar(
                                SnackBar(
                                  content: Text(
                                    'Şifre sıfırlama linki gönderildi',
                                  ),
                                ),
                              );
                            },
                            child: Text('Şifremi Unuttum'),
                          ),
                        ],
                      ),
                      SizedBox(height: 24),
                      SizedBox(
                        width: double.infinity,
                        height: 50,
                        child: ElevatedButton(
                          onPressed: () {
                            if (_formKey.currentState!.validate()) {
                              ScaffoldMessenger.of(context).showSnackBar(
                                SnackBar(
                                  content: Text(
                                    'Giriş başarılı! Hoş geldiniz ${_usernameController.text}',
                                  ),
                                  backgroundColor: Colors.green,
                                ),
                              );
                              Future.delayed(
                                Duration(seconds: 2),
                                () => Navigator.pop(context),
                              );
                            }
                          },
                          style: ElevatedButton.styleFrom(
                            backgroundColor: Colors.orange.shade800,
                            shape: RoundedRectangleBorder(
                              borderRadius: BorderRadius.circular(12),
                            ),
                          ),
                          child: Text(
                            'Giriş Yap',
                            style: TextStyle(
                              fontSize: 18,
                              fontWeight: FontWeight.bold,
                              color: Colors.white,
                            ),
                          ),
                        ),
                      ),
                      SizedBox(height: 20),
                      Row(
                        mainAxisAlignment: MainAxisAlignment.center,
                        children: [
                          Text('Hesabınız yok mu?'),
                          SizedBox(width: 8),
                          TextButton(
                            onPressed: () {
                              Navigator.pushReplacement(
                                context,
                                MaterialPageRoute(
                                  builder: (context) => RegisterPage(),
                                ),
                              );
                            },
                            child: Text(
                              'Kayıt Olun',
                              style: TextStyle(
                                fontWeight: FontWeight.bold,
                                color: Colors.orange.shade800,
                              ),
                            ),
                          ),
                        ],
                      ),
                    ],
                  ),
                ),
              ),
            ),
          ),
        ),
      ),
    );
  }

  @override
  void dispose() {
    _usernameController.dispose();
    _passwordController.dispose();
    super.dispose();
  }
}

class RegisterPage extends StatefulWidget {
  const RegisterPage({super.key});
  @override
  State<RegisterPage> createState() => _RegisterPageState();
}

class _RegisterPageState extends State<RegisterPage> {
  final _formKey = GlobalKey<FormState>();
  final _usernameController = TextEditingController();
  final _emailController = TextEditingController();
  final _passwordController = TextEditingController();
  final _confirmPasswordController = TextEditingController();
  bool _obscurePassword = true;
  bool _obscureConfirmPassword = true;
  bool _acceptTerms = false;

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Kayıt Ol'),
        backgroundColor: Colors.green.shade700,
      ),
      body: Container(
        decoration: BoxDecoration(
          gradient: LinearGradient(
            colors: [Colors.orange.shade50, Colors.amber.shade50],
            begin: Alignment.topLeft,
            end: Alignment.bottomRight,
          ),
        ),
        child: Center(
          child: SingleChildScrollView(
            padding: EdgeInsets.all(24),
            child: Card(
              elevation: 8,
              shape: RoundedRectangleBorder(
                borderRadius: BorderRadius.circular(16),
              ),
              child: Padding(
                padding: EdgeInsets.all(32),
                child: Form(
                  key: _formKey,
                  child: Column(
                    mainAxisSize: MainAxisSize.min,
                    children: [
                      Container(
                        width: 80,
                        height: 80,
                        decoration: BoxDecoration(
                          color: Colors.green.shade100,
                          shape: BoxShape.circle,
                        ),
                        child: Icon(
                          Icons.person_add,
                          size: 40,
                          color: Colors.green.shade800,
                        ),
                      ),
                      SizedBox(height: 24),
                      Text(
                        'Kayıt Ol',
                        style: TextStyle(
                          fontSize: 28,
                          fontWeight: FontWeight.bold,
                          color: Colors.green.shade800,
                        ),
                      ),
                      SizedBox(height: 8),
                      Text(
                        'Yeni bir hesap oluşturun',
                        style: TextStyle(
                          fontSize: 16,
                          color: Colors.grey.shade600,
                        ),
                      ),
                      SizedBox(height: 32),
                      TextFormField(
                        controller: _usernameController,
                        decoration: InputDecoration(
                          labelText: 'Kullanıcı Adı',
                          prefixIcon: Icon(Icons.person),
                          border: OutlineInputBorder(
                            borderRadius: BorderRadius.circular(12),
                          ),
                        ),
                        validator: (value) {
                          if (value == null || value.isEmpty)
                            return 'Lütfen kullanıcı adınızı giriniz';
                          if (value.length < 3)
                            return 'Kullanıcı adı en az 3 karakter olmalıdır';
                          return null;
                        },
                      ),
                      SizedBox(height: 20),
                      TextFormField(
                        controller: _emailController,
                        keyboardType: TextInputType.emailAddress,
                        decoration: InputDecoration(
                          labelText: 'E-posta',
                          prefixIcon: Icon(Icons.email),
                          border: OutlineInputBorder(
                            borderRadius: BorderRadius.circular(12),
                          ),
                        ),
                        validator: (value) {
                          if (value == null || value.isEmpty)
                            return 'Lütfen e-posta adresinizi giriniz';
                          if (!value.contains('@'))
                            return 'Geçerli bir e-posta adresi giriniz';
                          return null;
                        },
                      ),
                      SizedBox(height: 20),
                      TextFormField(
                        controller: _passwordController,
                        obscureText: _obscurePassword,
                        decoration: InputDecoration(
                          labelText: 'Şifre',
                          prefixIcon: Icon(Icons.lock),
                          suffixIcon: IconButton(
                            icon: Icon(
                              _obscurePassword
                                  ? Icons.visibility
                                  : Icons.visibility_off,
                            ),
                            onPressed: () => setState(
                              () => _obscurePassword = !_obscurePassword,
                            ),
                          ),
                          border: OutlineInputBorder(
                            borderRadius: BorderRadius.circular(12),
                          ),
                        ),
                        validator: (value) {
                          if (value == null || value.isEmpty)
                            return 'Lütfen şifrenizi giriniz';
                          if (value.length < 6)
                            return 'Şifre en az 6 karakter olmalıdır';
                          return null;
                        },
                      ),
                      SizedBox(height: 20),
                      TextFormField(
                        controller: _confirmPasswordController,
                        obscureText: _obscureConfirmPassword,
                        decoration: InputDecoration(
                          labelText: 'Şifre Tekrar',
                          prefixIcon: Icon(Icons.lock_outline),
                          suffixIcon: IconButton(
                            icon: Icon(
                              _obscureConfirmPassword
                                  ? Icons.visibility
                                  : Icons.visibility_off,
                            ),
                            onPressed: () => setState(
                              () => _obscureConfirmPassword =
                                  !_obscureConfirmPassword,
                            ),
                          ),
                          border: OutlineInputBorder(
                            borderRadius: BorderRadius.circular(12),
                          ),
                        ),
                        validator: (value) {
                          if (value == null || value.isEmpty)
                            return 'Lütfen şifrenizi tekrar giriniz';
                          if (value != _passwordController.text)
                            return 'Şifreler eşleşmiyor';
                          return null;
                        },
                      ),
                      SizedBox(height: 20),
                      Row(
                        children: [
                          Checkbox(
                            value: _acceptTerms,
                            onChanged: (value) =>
                                setState(() => _acceptTerms = value!),
                          ),
                          Expanded(
                            child: GestureDetector(
                              onTap: () => showDialog(
                                context: context,
                                builder: (context) => AlertDialog(
                                  title: Text('Kullanım Koşulları'),
                                  content: SingleChildScrollView(
                                    child: Text(
                                      'Bu platform Sahil Güvenlik eğitim ve öğretim faaliyetleri için tasarlanmıştır. Tüm kullanıcılar gizlilik politikasına ve kullanım koşullarına uymakla yükümlüdür.',
                                    ),
                                  ),
                                  actions: [
                                    TextButton(
                                      onPressed: () => Navigator.pop(context),
                                      child: Text('Tamam'),
                                    ),
                                  ],
                                ),
                              ),
                              child: Text(
                                'Kullanım koşullarını kabul ediyorum',
                                style: TextStyle(
                                  color: Colors.blue.shade700,
                                  decoration: TextDecoration.underline,
                                ),
                              ),
                            ),
                          ),
                        ],
                      ),
                      SizedBox(height: 24),
                      SizedBox(
                        width: double.infinity,
                        height: 50,
                        child: ElevatedButton(
                          onPressed: _acceptTerms ? _register : null,
                          style: ElevatedButton.styleFrom(
                            backgroundColor: Colors.green.shade800,
                            shape: RoundedRectangleBorder(
                              borderRadius: BorderRadius.circular(12),
                            ),
                          ),
                          child: Text(
                            'Kayıt Ol',
                            style: TextStyle(
                              fontSize: 18,
                              fontWeight: FontWeight.bold,
                              color: Colors.white,
                            ),
                          ),
                        ),
                      ),
                      SizedBox(height: 20),
                      Row(
                        mainAxisAlignment: MainAxisAlignment.center,
                        children: [
                          Text('Zaten hesabınız var mı?'),
                          TextButton(
                            onPressed: () => Navigator.pushReplacement(
                              context,
                              MaterialPageRoute(
                                builder: (context) => LoginPage(),
                              ),
                            ),
                            child: Text(
                              'Giriş Yapın',
                              style: TextStyle(
                                fontWeight: FontWeight.bold,
                                color: Colors.green.shade800,
                              ),
                            ),
                          ),
                        ],
                      ),
                    ],
                  ),
                ),
              ),
            ),
          ),
        ),
      ),
    );
  }

  void _register() {
    if (_formKey.currentState!.validate()) {
      ScaffoldMessenger.of(context).showSnackBar(
        SnackBar(
          content: Text(
            'Kayıt başarılı! Hoş geldiniz ${_usernameController.text}',
          ),
          backgroundColor: Colors.green,
        ),
      );
      Future.delayed(
        Duration(seconds: 2),
        () => Navigator.pushReplacement(
          context,
          MaterialPageRoute(builder: (context) => LoginPage()),
        ),
      );
    }
  }

  @override
  void dispose() {
    _usernameController.dispose();
    _emailController.dispose();
    _passwordController.dispose();
    _confirmPasswordController.dispose();
    super.dispose();
  }
}
